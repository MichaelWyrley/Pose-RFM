# Diverse Pose Generation using Riemanian Flow Matching

This Project aims to generate a diverse set of poses through the use of Riemanian Flow Matching.

![Pose](/out.mp4)

## Install

### Install and Pre-Process AMASS

If you want to train your own model on the dataset used in the paper then it can be accessed from the AMASS [website](https://amass.is.tue.mpg.de/)

The file structure and preprocessing steps used are the same as in NRDF so follow the steps specified there [website](https://github.com/hynann/NRDF/blob/master/docs/data.md)

### Requirments For Project

The specific python librarys used for the project can be downloaded from requirements.txt
This can be done using [Requirements](/docs/pythonenv.md) 

### Install Best Model 

The best current model can be found at best_model/ema_model_1200.pt 

## Training

If you want to train your own model then run the code in `main.py`

The parameters can be modified in the args dictionary with these parameters
- 'directory': Location of the root directory of this project
- 'noisy': Location of the noisy data samples generated by preprocessing
- 'clean': Location of the clean data samples generated by preprocessing
- 'batch_size': How many clean pose files are used at any point in time 
- 'no_samples': How many samples are randomly taken from each file (so the total batch size is batch_size * no_samples)
- 'lr': The learning rate of the optimiser
- 'epochs': The number of epochs used to train the model
- 'samples': The number of arbitray generated poses to make at every 50th epoch
- 'load_model': The model at which to start the training (if starting from nothing set to 0)
- 'world_size': The amount of GPUs available (leave as default: torch.cuda.device_count(), unless have specific needs)

## Generate Poses

There are several different uses of the model that allow for different generation types.
If you want to generate diverse poses then go to [Pose Generation](/docs/pose_generation.md)
Examples of how to use any functions can be seen in the `if __name__ == '__main__':` section in any of the files specified

# Acknowledgements 

Here are all the other systems that helped:
- [NRDF](https://github.com/hynann/NRDF) Neural Riemannian Distance Fields (specifically useful for the preprocessing step and utilities)
- [VPose](https://github.com/nghorbani/human_body_prior) Help generateing bodies 
- [AMASS](https://amass.is.tue.mpg.de/) The dataset used
- [SMPL](https://smpl.is.tue.mpg.de/) The body used to visualise the data
- [Body Visualiser](https://github.com/nghorbani/body_visualizer) The library to visualise the bodies
- [DiT](https://github.com/facebookresearch/DiT) The transformer architecture used to learn the Vector Fields
- [pytorch3d](https://github.com/facebookresearch/pytorch3d) A library used to convert between Euler angles and Rotation matrixes aswell as calculate the exp, log and geodesic distance for the rotation matrixes
